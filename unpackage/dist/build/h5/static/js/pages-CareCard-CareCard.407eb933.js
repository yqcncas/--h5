(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-CareCard-CareCard"],{"045a":function(e,a,t){"use strict";var r=t("ee27");t("ac1f"),t("466d"),t("5319"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,t("96cf");var o=r(t("c964")),n=r(t("262d")),i=t("3d69"),c={onLoad:function(e){e.code&&console.log(e.code),this.initCareInfo();var a=navigator.userAgent.toLowerCase();"micromessenger"==a.match(/MicroMessenger/i)||uni.getStorageSync("careCardOrderId")&&this.liulanqiPay()},onShow:function(){this.pagePath=this.$route.fullPath,console.log(this.pagePath)},data:function(){return{pagePath:"",payshow:!1,paySucessShow:!1,richText:"我是富文本",careCardPrice:0,productId:0,orderId:0,orderFlag:0,orderErrMsg:"",code:"",openid:"",careQrCode:""}},methods:{liulanqiPay:function(){var e=this;return(0,o.default)(regeneratorRuntime.mark((function a(){var t,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t=uni.getStorageSync("careCardOrderId"),a.next=3,e.$fetch(e.$api.orderInfo,{orderId:t},"GET","FORM");case 3:r=a.sent,30==r.data.status?(uni.showToast({icon:"success",title:"支付成功"}),e.careQrCode=r.data.carePic,e.careQrCode&&(e.paySucessShow=!0,e.payshow=!1)):uni.showToast({icon:"none",title:"支付失败"}),uni.removeStorageSync("careCardOrderId");case 6:case"end":return a.stop()}}),a)})))()},getWechatCode:function(){function e(e){var a=/(\w+)=(\w+)/gi,t={};return e.replace(a,(function(e,a,r){t[a]=r})),t}var a=window.location.href,t=e(a);return t.code},showPayShow:function(){this.payshow=!0,this.initCareOrder()},payMoney:function(){var e=this;return(0,o.default)(regeneratorRuntime.mark((function a(){var t,r,n,c,d;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(500!=e.orderFlag){a.next=2;break}return a.abrupt("return",uni.showToast({icon:"none",title:e.orderErrMsg}));case 2:if(uni.showLoading({title:"加载中"}),t=e,r=navigator.userAgent.toLowerCase(),"micromessenger"!=r.match(/MicroMessenger/i)){a.next=19;break}if(console.log("微信打开"),!uni.getStorageSync("openId")){a.next=17;break}return e.openid=uni.getStorageSync("openId"),a.next=11,e.$fetch(e.$api.gzPay,{openId:e.openid,orderId:e.orderId},"POST","FORM");case 11:n=a.sent,c=JSON.parse(n.data),uni.hideLoading(),i.config({debug:!1,appId:"wx5ce43c078d7bcc23",timestamp:c.timeStamp,nonceStr:c.nonceStr,signature:c.paySign,jsApiList:["chooseWXPay"]}),i.ready((function(){i.checkJsApi({jsApiList:["chooseWXPay"],success:function(e){console.log("checkjsapi Success"),console.log(e)},fail:function(e){console.log("res"),console.log(e)}}),i.chooseWXPay({timestamp:c.timeStamp,nonceStr:c.nonceStr,package:c.package,signType:c.signType,paySign:c.paySign,success:function(){var e=(0,o.default)(regeneratorRuntime.mark((function e(a){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return uni.showToast({icon:"success",title:"支付成功"}),e.next=3,t.$fetch(t.$api.orderInfo,{orderId:t.orderId},"GET","FORM");case 3:r=e.sent,t.careQrCode=r.data.carePic,t.careQrCode&&(t.paySucessShow=!0,t.payshow=!1),console.log(r);case 7:case"end":return e.stop()}}),e)})));function a(a){return e.apply(this,arguments)}return a}(),cancel:function(e){uni.showToast({icon:"none",title:"取消支付"}),console.log(e),console.log("/////////")},fail:function(e){uni.showToast({icon:"none",title:"支付失败"}),console.log(e),console.log("******")}})})),i.error((function(e){uni.showToast({icon:"none",title:"支付失败了",duration:4e3})}));case 17:a.next=29;break;case 19:return a.next=21,e.$fetch(e.$api.webPay,{orderId:e.orderId},"POST","FORM");case 21:if(d=a.sent,console.log(d),500!=d.code){a.next=27;break}return a.abrupt("return",uni.showToast({icon:"none",title:d.msg}));case 27:uni.hideLoading(),window.location.href=d.data+"&redirect_url=http%3A%2F%2Fh5.jjkkx.com/pages/CareCard/CareCard";case 29:case"end":return a.stop()}}),a)})))()},initCareInfo:function(){var e=this;return(0,o.default)(regeneratorRuntime.mark((function a(){var t,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.$fetch(e.$api.careInfo,{},"GET","FORM");case 2:t=a.sent,r=t.data,console.log(r),e.productId=r.productId,e.careCardPrice=r.price,e.richText=r.content;case 8:case"end":return a.stop()}}),a)})))()},initCareOrder:function(){var e=this;return(0,o.default)(regeneratorRuntime.mark((function a(){var t;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.$fetch(e.$api.careOrder,{productId:e.productId,num:1},"POST","FORM");case 2:t=a.sent,console.log(t),e.orderId=t.data,e.orderErrMsg=t.msg,e.orderFlag=t.code,uni.setStorageSync("careCardOrderId",e.orderId);case 8:case"end":return a.stop()}}),a)})))()}},components:{jyfParser:n.default}};a.default=c},"0dba":function(e,a,t){"use strict";var r=t("d740"),o=t.n(r);o.a},1144:function(e,a,t){e.exports=t.p+"static/img/11.5363e0b4.png"},"1de5":function(e,a,t){"use strict";e.exports=function(e,a){return a||(a={}),e=e&&e.__esModule?e.default:e,"string"!==typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),a.hash&&(e+=a.hash),/["'() \t\n]/.test(e)||a.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},"297a":function(e,a,t){var r=t("24fb");a=r(!1),a.push([e.i,"[data-v-22fd73d4] .u-drawer-bottom{border-radius:%?24?% %?24?% 0 0}[data-v-22fd73d4] .u-mode-center-box{border-radius:%?16?%;overflow:hidden}",""]),e.exports=a},"29b1":function(e,a,t){e.exports=t.p+"static/img/12.fe80082c.png"},5194:function(e,a,t){"use strict";t.r(a);var r=t("c28d"),o=t("bb3f");for(var n in o)"default"!==n&&function(e){t.d(a,e,(function(){return o[e]}))}(n);t("0dba"),t("98e2");var i,c=t("f0c5"),d=Object(c["a"])(o["default"],r["b"],r["c"],!1,null,"22fd73d4",null,!1,r["a"],i);a["default"]=d.exports},"85db":function(e,a,t){var r=t("24fb"),o=t("1de5"),n=t("9d02");a=r(!1);var i=o(n);a.push([e.i,".carecard[data-v-22fd73d4]{width:100%;height:100%;overflow:hidden;background-image:url("+i+");background-repeat:no-repeat;background-size:100% 100%}.carecard .carecard-header[data-v-22fd73d4]{width:100%;text-align:center;margin-top:%?36?%;-webkit-box-sizing:border-box;box-sizing:border-box}.carecard .carecard-header uni-image[data-v-22fd73d4]{width:%?678?%;height:%?362?%}.carecard .carecard-main[data-v-22fd73d4]{width:%?714?%;height:calc(100% - %?116?%);background:#fddb3c;-webkit-box-shadow:0 2px 4px 0 rgba(21,45,27,.5);box-shadow:0 2px 4px 0 rgba(21,45,27,.5);border-radius:8px;overflow:hidden;margin:0 auto;padding:%?16?% %?18?%;margin-top:%?18?%;-webkit-box-sizing:border-box;box-sizing:border-box}.carecard .carecard-main .carecard-main-top[data-v-22fd73d4]{text-align:center;font-family:PingFangSC-Regular;font-size:14px;color:#1f1f1f;letter-spacing:0}.carecard .carecard-main .carecard-main-top span[data-v-22fd73d4]{color:#ff9515}.carecard .carecard-main .carecard-main-center[data-v-22fd73d4]{font-family:PingFangSC-Medium;font-size:16px;color:#2a2a2a;letter-spacing:0;font-weight:700}.carecard .carecard-main .carecard-main-footer[data-v-22fd73d4]{height:58%;overflow-y:auto}.carecard .buy-button[data-v-22fd73d4]{position:fixed;bottom:%?162?%;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);text-align:center}.carecard .buy-button .buy-button-title[data-v-22fd73d4]{font-size:14px;font-family:PingFangSC-Medium;color:#ff9515}.carecard .buy-button .buy-button-title span[data-v-22fd73d4]{font-size:18px}.carecard .buy-button .buy-button-bottom[data-v-22fd73d4]{width:%?576?%;height:%?84?%;line-height:%?84?%;background:#ff9515;border-radius:21px;font-family:PingFangSC-Medium;font-size:18px;color:#fff;letter-spacing:0;text-align:center}.carecard .payshow-box[data-v-22fd73d4]{width:100%;-webkit-box-sizing:border-box;box-sizing:border-box}.carecard .payshow-box .payshow-header[data-v-22fd73d4]{padding-top:%?26?%;padding-left:%?36?%;padding-right:%?41?%;-webkit-box-sizing:border-box;box-sizing:border-box;background:#fff;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;align-items:center;border-radius:%?24?% %?24?% 0 0;overflow:hidden}.carecard .payshow-box .payshow-header .payshow-header-left[data-v-22fd73d4]{opacity:.9;font-family:PingFangSC-Medium;font-size:17px;color:#000;font-weight:700}.carecard .payshow-box .payshow-header .payshow-header-right[data-v-22fd73d4]{opacity:.9;font-family:PingFangSC-Medium;font-size:14px;color:#eb4f81}.carecard .payshow-box .payshow-header .payshow-header-right span[data-v-22fd73d4]{font-size:18px}.carecard .payshow-box .pay-way[data-v-22fd73d4]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;background-color:#fff;padding-left:%?42?%;padding-bottom:%?46?%;-webkit-box-sizing:border-box;box-sizing:border-box}.carecard .payshow-box .pay-way .pay-way-left[data-v-22fd73d4]{padding-top:%?54?%;-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-content:center;align-content:center}.carecard .payshow-box .pay-way .pay-way-left uni-image[data-v-22fd73d4]{width:%?74?%;height:%?82?%}.carecard .payshow-box .pay-way .pay-way-left .wxpay[data-v-22fd73d4]{line-height:%?82?%;padding-left:%?21?%;font-family:PingFangSC-Regular;font-size:17px;color:#000;-webkit-box-sizing:border-box;box-sizing:border-box}.carecard .payshow-box .pay-way .pay-way-right[data-v-22fd73d4]{padding-top:%?54?%;-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-content:center;align-content:center}.carecard .payshow-box .pay-tip[data-v-22fd73d4]{padding-left:%?38?%;padding-right:%?34?%;font-family:PingFangSC-Regular;font-size:14px;color:#000;line-height:20px;background-color:#fff;padding-bottom:%?12?%;-webkit-box-sizing:border-box;box-sizing:border-box}.carecard .payshow-box .pay-tip span[data-v-22fd73d4]{font-family:PingFangSC-Regular;font-size:14px;color:#56b4ff;line-height:20px}.carecard .payshow-box .pay[data-v-22fd73d4]{width:100%;height:%?116?%;line-height:%?116?%;text-align:center;opacity:.9;font-family:PingFangSC-Medium;font-size:17px;color:#fff;background:#fcca17}.carecard .paySucessShow-box[data-v-22fd73d4]{width:%?652?%;height:%?798?%;background:#fcca17;text-align:center;padding-top:%?20?%;-webkit-box-sizing:border-box;box-sizing:border-box}.carecard .paySucessShow-box .paySucessShow-box-top uni-image[data-v-22fd73d4]{width:%?148?%;height:%?252?%}.carecard .paySucessShow-box .paySucessShow-box-center[data-v-22fd73d4]{font-family:PingFangSC-Medium;font-size:18px;color:#fff;letter-spacing:0;padding-bottom:%?14?%;-webkit-box-sizing:border-box;box-sizing:border-box}.carecard .paySucessShow-box .paySucessShow-box-footer[data-v-22fd73d4]{padding-bottom:%?34?%;-webkit-box-sizing:border-box;box-sizing:border-box}.carecard .paySucessShow-box .paySucessShow-box-footer uni-image[data-v-22fd73d4]{width:%?310?%;height:%?310?%}.carecard .paySucessShow-box .paySucessShow-box-button[data-v-22fd73d4]{width:%?400?%;height:%?84?%;line-height:%?84?%;background:#ff9515;border-radius:21px;font-family:PingFangSC-Medium;font-size:18px;color:#fff;letter-spacing:0;text-align:center;margin:0 auto}",""]),e.exports=a},"98e2":function(e,a,t){"use strict";var r=t("b9b7"),o=t.n(r);o.a},"9d02":function(e,a,t){e.exports=t.p+"static/img/3.2e3de225.png"},b9b7:function(e,a,t){var r=t("297a");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var o=t("4f06").default;o("01c0375c",r,!0,{sourceMap:!1,shadowMode:!1})},bb3f:function(e,a,t){"use strict";t.r(a);var r=t("045a"),o=t.n(r);for(var n in r)"default"!==n&&function(e){t.d(a,e,(function(){return r[e]}))}(n);a["default"]=o.a},c28d:function(e,a,t){"use strict";var r={"jyf-parser":t("262d").default,"u-popup":t("f403").default,Tabbar:t("c11a").default},o=function(){var e=this,a=e.$createElement,r=e._self._c||a;return r("v-uni-view",{staticClass:"carecard"},[r("v-uni-view",{staticClass:"carecard-header"},[r("v-uni-image",{attrs:{src:t("1144"),mode:""}})],1),r("v-uni-view",{staticClass:"carecard-main"},[r("v-uni-view",{staticClass:"carecard-main-footer"},[r("jyf-parser",{ref:"article",attrs:{html:e.richText}})],1)],1),r("v-uni-view",{staticClass:"buy-button",on:{click:function(a){a.stopPropagation(),arguments[0]=a=e.$handleEvent(a),e.showPayShow.apply(void 0,arguments)}}},[r("v-uni-view",{staticClass:"buy-button-title"},[e._v("¥"),r("span",[e._v(e._s(e.careCardPrice))])]),r("v-uni-view",{staticClass:"buy-button-bottom"},[e._v("立刻关爱")])],1),r("u-popup",{attrs:{mode:"bottom"},model:{value:e.payshow,callback:function(a){e.payshow=a},expression:"payshow"}},[r("v-uni-view",{staticClass:"payshow-box"},[r("v-uni-view",{staticClass:"payshow-header"},[r("v-uni-view",{staticClass:"payshow-header-left"},[e._v("现在支付")]),r("v-uni-view",{staticClass:"payshow-header-right"},[e._v("¥"),r("span",[e._v(e._s(e.careCardPrice))])])],1),r("v-uni-view",{staticClass:"pay-way"},[r("v-uni-view",{staticClass:"pay-way-left"},[r("v-uni-image",{attrs:{src:t("29b1"),mode:""}}),r("v-uni-view",{staticClass:"wxpay"},[e._v("微信支付")])],1),r("v-uni-view",{staticClass:"pay-way-right"},[r("v-uni-label",{staticClass:"radio"},[r("v-uni-radio",{attrs:{value:"r1",checked:"true"}})],1)],1)],1),r("v-uni-view",{staticClass:"pay-tip"},[e._v("我同意"),r("span",[e._v("购买守则")]),e._v("，我也同意支付以下所示的总金额（含服务费）。")]),r("v-uni-view",{staticClass:"pay",on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.payMoney.apply(void 0,arguments)}}},[e._v("确认支付")])],1)],1),r("u-popup",{attrs:{mode:"center"},model:{value:e.paySucessShow,callback:function(a){e.paySucessShow=a},expression:"paySucessShow"}},[r("v-uni-view",{staticClass:"paySucessShow-box"},[r("v-uni-view",{staticClass:"paySucessShow-box-top"},[r("v-uni-image",{attrs:{src:t("618a"),mode:""}})],1),r("v-uni-view",{staticClass:"paySucessShow-box-center"},[e._v("支付成功,去关爱他人")]),r("v-uni-view",{staticClass:"paySucessShow-box-footer"},[r("v-uni-image",{attrs:{src:e.careQrCode,mode:"aspectFill"}})],1),r("v-uni-view",{staticClass:"paySucessShow-box-button"},[e._v("长按二维码, 保存图片")])],1)],1),r("Tabbar",{attrs:{pagePath:e.pagePath}})],1)},n=[];t.d(a,"b",(function(){return o})),t.d(a,"c",(function(){return n})),t.d(a,"a",(function(){return r}))},d740:function(e,a,t){var r=t("85db");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var o=t("4f06").default;o("473376d1",r,!0,{sourceMap:!1,shadowMode:!1})}}]);